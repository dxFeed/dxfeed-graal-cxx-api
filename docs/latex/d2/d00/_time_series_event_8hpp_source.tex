\doxysubsection{Time\+Series\+Event.\+hpp}
\hypertarget{_time_series_event_8hpp_source}{}\label{_time_series_event_8hpp_source}\index{TimeSeriesEvent.hpp@{TimeSeriesEvent.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ 2024\ Devexperts\ LLC.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ SPDX-\/License-\/Identifier:\ MPL-\/2.0}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{pragma}\ \textcolor{preprocessor}{once}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{include}\ \textcolor{preprocessor}{"{}../internal/Conf.hpp"{}}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{include}\ \textcolor{preprocessor}{<}\textcolor{preprocessor}{cstdint}\textcolor{preprocessor}{>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{include}\ \textcolor{preprocessor}{<}\textcolor{preprocessor}{memory}\textcolor{preprocessor}{>}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{include}\ \mbox{\hyperlink{_indexed_event_8hpp}{"{}IndexedEvent.hpp"{}}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{include}\ \mbox{\hyperlink{_indexed_event_source_8hpp}{"{}IndexedEventSource.hpp"{}}}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{namespace}\ dxfcpp\ \{}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{comment}{/**}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ Represents\ time-\/series\ snapshots\ of\ some\ process\ that\ is\ evolving\ in\ time\ or\ actual\ events\ in\ some\ external\ system}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *\ that\ have\ an\ associated\ time\ stamp\ and\ can\ be\ uniquely\ identified.}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ For\ example,\ TimeAndSale\ events\ represent\ the\ actual\ sales\ that\ happen\ on\ a\ market\ exchange\ at\ specific\ time}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *\ moments,\ while\ Candle\ events\ represent\ snapshots\ of\ aggregate\ information\ about\ trading\ over\ a\ specific\ time\ period.}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ *\ Time-\/series\ events\ can\ be\ used\ with\ DXFeedTimeSeriesSubscription\ to\ receive\ a\ time-\/series\ history\ of\ past\ events.}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ *\ Time-\/series\ events\ are\ conflated\ based\ on\ unique\ @ref\ ::getIndex()\ "{}index"{}\ for\ each\ symbol.}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ *\ Last\ indexed\ event\ for\ each\ symbol\ and\ index\ is\ always\ delivered\ to\ event\ listeners\ on\ subscription,\ but}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ *\ intermediate\ (next-\/to-\/last)\ events\ for\ each\ symbol+index\ pair\ are\ not\ queued\ anywhere,\ they\ are\ simply\ discarded\ as}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ *\ stale\ events.}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00028\ \textcolor{comment}{\ *\ Timestamp\ of\ an\ event\ is\ available\ via\ @ref\ ::getTime()\ "{}time"{}\ property\ with\ a\ millisecond\ precision.\ Some\ events}}
\DoxyCodeLine{00029\ \textcolor{comment}{\ *\ may\ happen\ multiple\ times\ per\ millisecond.\ In\ this\ case\ they\ have\ the\ same\ @ref\ ::getTime()\ "{}time"{},\ but\ different}}
\DoxyCodeLine{00030\ \textcolor{comment}{\ *\ @ref\ ::getIndex()\ "{}index"{}.\ An\ ordering\ of\ @ref\ ::getIndex()\ "{}index"{}\ is\ the\ same\ as\ an\ ordering}}
\DoxyCodeLine{00031\ \textcolor{comment}{\ *\ of\ @ref\ ::getTime()\ "{}time"{}.\ That\ is,\ an\ collection\ of\ time-\/series\ events\ that\ is\ ordered}}
\DoxyCodeLine{00032\ \textcolor{comment}{\ *\ by\ @ref\ ::getIndex()\ "{}index"{}\ is\ ascending\ order\ will\ be\ also\ ordered\ by\ @ref\ ::getTime()\ "{}time"{}\ in\ ascending\ order.}}
\DoxyCodeLine{00033\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00034\ \textcolor{comment}{\ *\ Time-\/series\ events\ are\ a\ more\ specific\ subtype\ of\ IndexedEvent.}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ *\ All\ general\ documentation\ and\ <a\ href="{}IndexedEvent.html\#eventFlagsSection"{}>Event\ Flags</a>\ section,\ in\ particular,}}
\DoxyCodeLine{00036\ \textcolor{comment}{\ *\ applies\ to\ time-\/series\ events.\ However,\ the\ time-\/series\ events\ never\ come\ from\ multiple\ sources\ for\ the\ same\ symbol}}
\DoxyCodeLine{00037\ \textcolor{comment}{\ *\ and\ their\ @ref\ TimeSeriesEvent::getSource()\ "{}source"{}\ is\ always\ @ref\ IndexedEventSource::DEFAULT\ "{}DEFAULT"{}.}}
\DoxyCodeLine{00038\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ *\ Unlike\ a\ general\ IndexedEvent\ that\ is\ subscribed\ to\ via\ DXFeedSubscription\}\ using\ a\ plain\ symbol\ to\ receive\ all}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ *\ events\ for\ all\ indices,\ time-\/series\ events\ are\ typically\ subscribed\ to\ using\ TimeSeriesSubscriptionSymbol\ class\ to}}
\DoxyCodeLine{00041\ \textcolor{comment}{\ *\ specific\ time\ range\ of\ the\ subscription.\ There\ is\ a\ dedicated\ DXFeedTimeSeriesSubscription\ class\ that\ is\ designed}}
\DoxyCodeLine{00042\ \textcolor{comment}{\ *\ to\ simplify\ the\ task\ of\ subscribing\ for\ time-\/series\ events.}}
\DoxyCodeLine{00043\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00044\ \textcolor{comment}{\ *\ TimeSeriesEventModel\ class\ handles\ all\ the\ snapshot\ and\ transaction\ logic\ and\ conveniently\ represents\ a\ list\ of}}
\DoxyCodeLine{00045\ \textcolor{comment}{\ *\ current\ time-\/series\ events\ ordered\ by\ their\ @ref\ TimeSeriesEvent::getTime()\ "{}time"{}.\ It\ relies\ on\ the\ code}}
\DoxyCodeLine{00046\ \textcolor{comment}{\ *\ of\ AbstractIndexedEventModel\ to\ handle\ this\ logic.}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ *\ Use\ the\ source\ code\ of\ AbstractIndexedEventModel\ for\ clarification\ on\ transactions\ and\ snapshot\ logic.}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00049\ \textcolor{comment}{\ *\ Classes\ that\ implement\ this\ interface\ may\ also\ implement\ LastingEvent\ interface,\ which\ makes\ it\ possible\ to\ use}}
\DoxyCodeLine{00050\ \textcolor{comment}{\ *\ DXFeed::getLastEvent()\ method\ to\ retrieve\ the\ last\ event\ for\ the\ corresponding\ symbol.}}
\DoxyCodeLine{00051\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00052\ \textcolor{comment}{\ *\ <h3>Publishing\ time-\/series</h3>}}
\DoxyCodeLine{00053\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00054\ \textcolor{comment}{\ *\ When\ publishing\ time-\/series\ event\ with\ DXPublisher::publishEvents()\ method\ on\ incoming\ TimeSeriesSubscriptionSymbol}}
\DoxyCodeLine{00055\ \textcolor{comment}{\ *\ the\ snapshot\ of\ currently\ known\ events\ for\ the\ requested\ time\ range\ has\ to\ be\ published\ first.}}
\DoxyCodeLine{00056\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00057\ \textcolor{comment}{\ *\ A\ snapshot\ is\ published\ in\ the\ <em>descending</em>\ order\ of\ @ref\ TimeSeriesEvent::getIndex()\ "{}index"{}\ (which\ is\ the}}
\DoxyCodeLine{00058\ \textcolor{comment}{\ *\ same\ as\ the\ descending\ order\ of\ @ref\ TimeSeriesEvent::getTime()\ "{}time"{}),\ starting\ with\ an\ event\ with\ the\ largest}}
\DoxyCodeLine{00059\ \textcolor{comment}{\ *\ index\ and\ marking\ it\ with\ TimeSeriesEvent::SNAPSHOT\_BEGIN\ bit\ in\ @ref\ TimeSeriesEvent::getEventFlags\ "{}eventFlags"{}.}}
\DoxyCodeLine{00060\ \textcolor{comment}{\ *\ All\ other\ event\ follow\ with\ default,\ zero}}
\DoxyCodeLine{00061\ \textcolor{comment}{\ *\ @ref\ TimeSeriesEvent::getEventFlags()\ "{}eventFlags"{}.\ If\ there\ is\ no\ actual\ event\ at\ the\ time\ that\ was\ specified\ in}}
\DoxyCodeLine{00062\ \textcolor{comment}{\ *\ subscription}}
\DoxyCodeLine{00063\ \textcolor{comment}{\ *\ @ref\ TimeSeriesSubscriptionSymbol::getFromTime()\ "{}fromTime"{}\ property,\ then\ event\ with\ the\ corresponding\ time}}
\DoxyCodeLine{00064\ \textcolor{comment}{\ *\ has\ to\ be\ created\ anyway\ and\ published.\ To\ distinguish\ it\ from\ the\ actual\ event,\ it\ has\ to\ be\ marked\ with}}
\DoxyCodeLine{00065\ \textcolor{comment}{\ *\ TimeSeriesEvent::REMOVE\_EVENT\ bit\ in\ @ref\ TimeSeriesEvent::getEventFlags()\ "{}eventFlags"{}.}}
\DoxyCodeLine{00066\ \textcolor{comment}{\ *\ TimeSeriesEvent::SNAPSHOT\_END\ bit\ in\ this\ event's}}
\DoxyCodeLine{00067\ \textcolor{comment}{\ *\ @ref\ TimeSeriesEvent::getEventFlags()\ "{}eventFlags"{}\ s\ optional\ during\ publishing.\ It\ will\ be\ properly\ set\ on\ receiving}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ *\ end\ anyway.\ Note,\ that\ publishing\ any\ event\ with\ time\ that\ is\ below\ subscription}}
\DoxyCodeLine{00069\ \textcolor{comment}{\ *\ @ref\ TimeSeriesSubscriptionSymbol::getFromTime()\ "{}fromTime"{}\ also\ works\ as\ a\ legal\ indicator\ for\ the\ end\ of\ the}}
\DoxyCodeLine{00070\ \textcolor{comment}{\ *\ snapshot.}}
\DoxyCodeLine{00071\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00072\ \textcolor{comment}{\ *\ Both\ TimeAndSale\ and\ Candle\ time-\/series\ events\ define\ a\ sequence\ property\ that\ is\ mixed\ into\ an}}
\DoxyCodeLine{00073\ \textcolor{comment}{\ *\ @ref\ ::getIndex()\ "{}index"{}\ property.\ It\ provides\ a\ way\ to\ distinguish\ different\ events\ at\ the\ same\ time.\ For\ a}}
\DoxyCodeLine{00074\ \textcolor{comment}{\ *\ snapshot\ end\ event\ the\ sequence\ has\ to\ be\ left\ at\ its\ default\ zero\ value.\ It\ means,\ that\ if\ there\ is\ an\ actual}}
\DoxyCodeLine{00075\ \textcolor{comment}{\ *\ event\ to\ be\ published\ at\ subscription\ @ref\ TimeSeriesSubscriptionSymbol::getFromTime()\ "{}fromTime"{}\ with\ non-\/zero}}
\DoxyCodeLine{00076\ \textcolor{comment}{\ *\ sequence,\ then\ generation\ of\ an\ additional\ snapshot\ end\ event\ with\ the\ subscription}}
\DoxyCodeLine{00077\ \textcolor{comment}{\ *\ @ref\ TimeSeriesSubscriptionSymbol::getFromTime()\ "{}fromTime"{}\ and\ zero\ sequence\ is\ still\ required.}}
\DoxyCodeLine{00078\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00079\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{_conf_8hpp_a2247137e794d0adca60e1208433f3ec9}{DXFCPP\_EXPORT}}\ \mbox{\hyperlink{structdxfcpp_1_1_time_series_event}{TimeSeriesEvent}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structdxfcpp_1_1_indexed_event}{IndexedEvent}}\ \{}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{comment}{///\ The\ alias\ to\ a\ type\ of\ shared\ pointer\ to\ the\ TimeSeriesEvent\ object}}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keyword}{using}\ Ptr\ =\ std::shared\_ptr<\mbox{\hyperlink{structdxfcpp_1_1_time_series_event}{TimeSeriesEvent}}>;}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{comment}{/**}}
\DoxyCodeLine{00084\ \textcolor{comment}{\ \ \ \ \ *\ Returns\ the\ source\ identifier\ for\ this\ event,\ which\ is\ always\ @ref\ IndexedEventSource::DEFAULT\ "{}DEFAULT"{}\ for}}
\DoxyCodeLine{00085\ \textcolor{comment}{\ \ \ \ \ *\ time-\/series\ events.}}
\DoxyCodeLine{00086\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00087\ \textcolor{comment}{\ \ \ \ \ *\ @return\ The\ source\ identifier\ for\ this\ event,\ which\ is\ always\ @ref\ IndexedEventSource::DEFAULT\ "{}DEFAULT"{}\ for}}
\DoxyCodeLine{00088\ \textcolor{comment}{\ \ \ \ \ *\ time-\/series\ events.}}
\DoxyCodeLine{00089\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdxfcpp_1_1_indexed_event_source}{IndexedEventSource}}\ \&\mbox{\hyperlink{structdxfcpp_1_1_time_series_event_a9a57a9c2bcb8de5457275edf8781e626}{getSource}}()\ \textcolor{keyword}{const}\ \&\ \textcolor{keyword}{noexcept}\ \textcolor{keyword}{override}\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdxfcpp_1_1_indexed_event_source}{IndexedEventSource}}\mbox{\hyperlink{classdxfcpp_1_1_indexed_event_source_ab7bc1a5037c8e18b2adeb45237cea5eb}{::}}\mbox{\hyperlink{classdxfcpp_1_1_indexed_event_source_ab7bc1a5037c8e18b2adeb45237cea5eb}{DEFAULT}};}
\DoxyCodeLine{00092\ \ \ \ \ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{comment}{/**}}
\DoxyCodeLine{00095\ \textcolor{comment}{\ \ \ \ \ *\ Returns\ unique\ per-\/symbol\ index\ of\ this\ event.}}
\DoxyCodeLine{00096\ \textcolor{comment}{\ \ \ \ \ *\ Event\ indices\ are\ unique\ within\ event\ symbol.}}
\DoxyCodeLine{00097\ \textcolor{comment}{\ \ \ \ \ *\ Typically\ event\ index\ for\ a\ time\ series\ event\ includes\ @ref\ ::getTime()\ "{}time"{}\ inside.}}
\DoxyCodeLine{00098\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00099\ \textcolor{comment}{\ \ \ \ \ *\ <h3>Implementation\ notes</h3>}}
\DoxyCodeLine{00100\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00101\ \textcolor{comment}{\ \ \ \ \ *\ The\ most\ common\ scheme\ for\ event\ indices\ is\ to\ set\ highest\ 32\ bits\ of\ event\ index}}
\DoxyCodeLine{00102\ \textcolor{comment}{\ \ \ \ \ *\ to\ event\ timestamp\ in\ seconds.\ The\ lowest\ 32\ bits\ are\ then\ split\ as\ follows.}}
\DoxyCodeLine{00103\ \textcolor{comment}{\ \ \ \ \ *\ Bits\ 22\ to\ 31\ encode\ milliseconds\ of\ time\ stamp,\ and\ bits\ 0\ to\ 21\ encode\ some}}
\DoxyCodeLine{00104\ \textcolor{comment}{\ \ \ \ \ *\ kind\ of\ a\ sequence\ number.}}
\DoxyCodeLine{00105\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00106\ \textcolor{comment}{\ \ \ \ \ *\ Ultimately,\ the\ scheme\ for\ event\ indices\ is\ specific\ for\ each\ even\ type.}}
\DoxyCodeLine{00107\ \textcolor{comment}{\ \ \ \ \ *\ The\ actual\ classes\ for\ specific\ event\ types\ perform\ the\ corresponding\ encoding.}}
\DoxyCodeLine{00108\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00109\ \textcolor{comment}{\ \ \ \ \ *\ @return\ unique\ per-\/symbol\ index\ of\ this\ event.}}
\DoxyCodeLine{00110\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00111\ \ \ \ \ std::int64\_t\ \mbox{\hyperlink{structdxfcpp_1_1_time_series_event_a3644682dc63411ac2ef4739a3bba42ab}{getIndex}}()\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \textcolor{keyword}{override}\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00113\ \ \ \ \ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{comment}{/**}}
\DoxyCodeLine{00116\ \textcolor{comment}{\ \ \ \ \ *\ Returns\ unique\ per-\/symbol\ index\ of\ this\ event.}}
\DoxyCodeLine{00117\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00118\ \textcolor{comment}{\ \ \ \ \ *\ @return\ unique\ per-\/symbol\ index\ of\ this\ event.}}
\DoxyCodeLine{00119\ \textcolor{comment}{\ \ \ \ \ *\ @deprecated\ Use\ ::getIndex()}}
\DoxyCodeLine{00120\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keyword}{virtual}\ std::int64\_t\ \mbox{\hyperlink{structdxfcpp_1_1_time_series_event_ac387c8c64f3fcfe2163d1e42e89cdbb1}{getEventId}}()\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdxfcpp_1_1_time_series_event_a3644682dc63411ac2ef4739a3bba42ab}{getIndex}}\mbox{\hyperlink{structdxfcpp_1_1_time_series_event_a3644682dc63411ac2ef4739a3bba42ab}{(}}\mbox{\hyperlink{structdxfcpp_1_1_time_series_event_a3644682dc63411ac2ef4739a3bba42ab}{)}};}
\DoxyCodeLine{00123\ \ \ \ \ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{comment}{/**}}
\DoxyCodeLine{00126\ \textcolor{comment}{\ \ \ \ \ *\ Returns\ timestamp\ of\ the\ event.}}
\DoxyCodeLine{00127\ \textcolor{comment}{\ \ \ \ \ *\ The\ timestamp\ is\ in\ milliseconds\ from\ midnight,\ January\ 1,\ 1970\ UTC.}}
\DoxyCodeLine{00128\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00129\ \textcolor{comment}{\ \ \ \ \ *\ @return\ timestamp\ of\ the\ event.}}
\DoxyCodeLine{00130\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keyword}{virtual}\ std::int64\_t\ \mbox{\hyperlink{structdxfcpp_1_1_time_series_event_a0946cef283e17bf4fb2a4fd42d8d3554}{getTime}}()\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ =\ 0;}
\DoxyCodeLine{00132\ \};}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \}\ \textcolor{comment}{//\ namespace\ dxfcpp}}

\end{DoxyCode}
